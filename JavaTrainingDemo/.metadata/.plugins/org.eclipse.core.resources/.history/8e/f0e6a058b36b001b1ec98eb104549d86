package com.highradius;

import java.io.*;
import java.util.*;
import java.sql.*;
import javax.servlet.ServletException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.annotation.WebServlet;

public class DBConnector extends HttpServlet {
	
	public static void main(String[] args) throws Exception
	{
		
		Connection dbConnection = null;
		PreparedStatement prStmt = null;
		ResultSet rS = null;
		
		String url = "jdbc:mysql://localhost:3306/sakila";
		String userName = "root";
		String passWord = "root";
		String query = "SELECT * FROM film LIMIT 1;";
		
		try {
			// Registering JDBC Driver
			Class.forName("com.mysql.jdbc.Driver");
			
			// Open a Connection
			dbConnection = DriverManager.getConnection(url, userName, passWord);
			if(dbConnection != null)	
				System.out.println("DB Connected!");
			
			// Execute SQL Query
			prStmt = dbConnection.prepareStatement(query);
			System.out.println("Executing Query...");
			rS = prStmt.executeQuery();
			
		}
		catch(Exception e) {
			e.printStackTrace();
		}
		
		finally {
			rS.close();
			dbConnection.close();
			prStmt.close();
			System.out.println("DB Connection Closed!");
		}
	}
}
